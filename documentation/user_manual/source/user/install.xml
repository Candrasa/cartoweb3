<?xml version="1.0" encoding='ISO-8859-1'?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN"
  "http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd" [
  <!ENTITY % cartoweb SYSTEM "../cartoweb.ent" >
  %cartoweb;
]>

<!-- $Id$ -->

<chapter id="user.install">
 <title>Installation</title>

 <sect1 id="user.install.unix.debian">
  <title>Mapserver Debian Installation</title>
  <para>FIXME: put this into unix install ??</para>
  <para>Some Debian packages are available for Php5 and Mapserver<footnote>
    <para>Some of the packages were inspired from 
      <ulink url="http://agrogeomatic.educagri.fr/"/></para>
    </footnote>. For now
    only the cgi version of Php is available because of threading issues with 
    Mapserver. 
  </para>
  <sect2>
  <title>Prerequisites for Debian Woody</title>  
  <para>
    These packages have some dependencies on packages available in the so-called
    Sarge Debian repository version. Thus, if you are using Debian Woody, you 
    will need to add the following lines to your 
      <filename>/etc/apt/sources.list</filename>:
      <screen><![CDATA[#debian sarge
deb http://ftp.<country>.debian.org/debian/ sarge main contrib]]></screen>
    Of course, replace &lt;country&gt; by two country letter of your nearest mirror.
    See <ulink url="http://www.debian.org/mirror/list"/> for the full mirror list.
  </para>
  </sect2>
  
  <sect2>
  <title>Setting Up Your Repository and Preferences File</title>  
  <para>
    Add the following to your <filename>/etc/apt/sources.list</filename>  :
    <screen># cartoweb
deb http://dev.camptocamp.com/packages/debian/ sarge main
deb-src http://dev.camptocamp.com/packages/debian/ sarge main</screen>
  </para>
  <para>
    You may want to pin c2c packages higher than 1000 to have them preferred over
     the upstream ones, even if downgrading. Add in <filename>/etc/apt/preferences</filename>:
     <screen>Package: *
Pin: release o=c2c
Pin-Priority: 1100</screen>
  </para>
  </sect2>  

  <sect2>
  <title>Additional Steps</title>  
  <para>
    <orderedlist>
      <listitem>
        <para>Update your <filename>/etc/php5-c2cms-cgi/php.ini</filename> to 
          load the <literal>php_mapscript.so</literal> extension:
          <screen>extension=php_mapscript.so</screen>
          </para>
      </listitem>
    </orderedlist>
    <orderedlist>
      <listitem>
        <para> you may want to raise the memory limit:
          <screen>memory_limit = 30M</screen>
          </para>
      </listitem>
    </orderedlist>    
  </para>
  </sect2>
 </sect1>
   
 <sect1 id="user.install.unix">
  <title>UNIX-like Install</title>
  <para>
    &cartoweb; installer is "cw3setup.php", located in the root directory of the application:
    Simply run <screen>php -f cw3setup.php</screen> to setup the application.
  </para>
  <sect2 id="user.install.unix.commands.list">
   <title>List of Available Commands</title>
    <para>
<screen><![CDATA[(no command, by default): install cartoweb3
cvs                     : install cartoweb3 from cvs
check                   : check configuration
get[=user]              : CVS checkout with user name [anonymous]
get_libs                : get required libraries
dirs                    : create user directories
perms[=www-data]        : set writing perms for web-user [www-data]
                          - set ownership if ran as superuser,
                          - give write permission instead.
createConfig            : create the new configuration (install .dist files)
setupLinks              : link or copy paths for web browser
removeLinks             : remove all links created by setupLinks.
                          - super user rights required to remove dynamic content
setup[=path]            : setup a new project in existing installation
mkDirs                  : create all cache directories
rmDirs                  : remove all temporary files AND directories
remove                  : remove cartoweb3
]]></screen>
    </para>
   </sect2>
   <sect2 id="user.install.unix.commands.details">
    <title>Commands Details</title>
      <itemizedlist>
       <listitem><para>(no command, by default): install &cartoweb; from a download.</para></listitem>
       <listitem><para>cvs: install &cartoweb; from a cvs checkout. You must have cvs access configured and cvs login done with the right user name.</para></listitem>
       <listitem><para>check: check if the configuration meet requirements.</para></listitem>
       <listitem><para>get[=user]: CVS checkout with user name "user". You must have done succesfully a cvs login before.</para></listitem>
       <listitem><para>get_libs: fetch required libraries. You need an internet connection.</para></listitem>
       <listitem><para>perms[=www-data]: set writing perms for web-user [www-data]. Set the ownership if ran as superuser, and give write permission instead. Warning: the second choice is secureless.</para></listitem>
       <listitem><para>createConfig: create configuration from .dist files.</para></listitem>
       <listitem><para>setupLinks: setup symbolic links for a <link linkend="user.config.client">SymLink</link> configuration.</para></listitem>
       <listitem><para>removeLinks: remove links created by setupLinks.</para></listitem>
       <listitem><para>setup[=path]: setup a new &cartoweb; project from project sources located in path. </para></listitem>
       <listitem><para>mkDirs: make user-writeables directories.</para></listitem>
       <listitem><para>rmDirs: remove user-writeable directories.</para></listitem>
       <listitem><para>remove: try to completely remove &cartoweb;. Super-user rights may be required for user-writed directories removal.</para></listitem>
      </itemizedlist>
   </sect2>
 </sect1>


 <sect1 id="user.install.win32">
  <title>Windows Install</title>
  <para>
   The process is as simple as for UNIX, but the windows installer is not available yet.
  </para>
 </sect1>

</chapter>
