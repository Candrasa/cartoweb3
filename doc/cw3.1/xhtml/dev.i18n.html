<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <title>4. Internationalization</title>
    <link rel="stylesheet" href="document.css" type="text/css" />
    <meta name="generator" content="Tiny DocBook - 1.6.16" />
  </head>
  <body>
    <div id="prev_next">
      <p id="prev">
        <a accesskey="p" href="dev.security.html">
       &lt; Using the Security Infrastructure</a>
      </p>
      <p id="next">
        <a accesskey="n" href="dev.code_convention.html">Code Convention &gt;
     </a>
      </p>
    </div>
    <div id="navtoc">
      <div id="nav">
        <ul>
          <li>
            <a accesskey="h" href="index.html">CartoWeb Documentation</a>
          </li>
          <li>
            <a accesskey="u" href="cartoweb.dev.html">Developer Manual</a>
          </li>
        </ul>
      </div>
      <div id="toc">
        <p>Table of Contents</p>
        <ul>
          <li>
            <span class="sect1">
              <a href="dev.i18n.html#dev.i18n.translations">4.1. Translations</a>
            </span>
          </li>
          <li>
            <span class="sect1">
              <a href="dev.i18n.html#dev.i18n.encoding">4.2. Character Set Encoding</a>
            </span>
          </li>
        </ul>
      </div>
    </div>
    <div id="title">
      <h2 class="title"><a id="dev.i18n"></a>4. Internationalization</h2>
    </div>
    <div id="content">
      <div class="chapter" lang="en" xml:lang="en">
        <div class="titlepage">
          <div>
            <div></div>
          </div>
        </div>
        <div class="sect1" lang="en" xml:lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title"><a id="dev.i18n.translations"></a>4.1. Translations</h2>
              </div>
            </div>
          </div>
          <p> Texts to be translated can be found in: </p>
          <div class="itemizedlist">
            <ul>
              <li> Smarty templates (see <a href="user.template.html#user.template.i18n" title="16.2. Internationalization">Section 16.2, &#8220;Internationalization&#8221;</a>)</li>
              <li> Client and server .ini files and map files (see <a href="user.config.html" title="4. Configuration Files">Chapter 4, <i>Configuration Files</i></a>) </li>
              <li> Client and server PHP code </li>
            </ul>
          </div>
          <p> In the last case, the script which finds strings to be translated 
      (see <a href="user.i18n.html#user.i18n.translations.template" title="15.1.2. PO Templates">Section 15.1.2, &#8220;PO Templates&#8221;</a>) looks for calls 
      to <code class="function">gt()</code> functions. There are two different 
      <code class="function">gt()</code> functions: </p>
          <div class="itemizedlist">
            <ul>
              <li><code class="function">I18n::gt()</code>: tries to translate the string 
          given as argument and returns the translation. This function assumes 
          that string is UTF-8 encoded and returns a string ready for output 
          (see <a href="dev.i18n.html#dev.i18n.encoding" title="4.2. Character Set Encoding">Section 4.2, &#8220;Character Set Encoding&#8221;</a>). It can be used on client 
          side only </li>
              <li><code class="function">I18nNoop::gt()</code>: does nothing during runtime 
          ("noop" stands for "no operations"). Call to this function is only 
          needed to indicates that the string must be translated. This function 
          can be used on client and server side </li>
            </ul>
          </div>
          <p>Below is an example on how to use <span><strong class="command">I18nNoop::gt()</strong></span>: 
      </p>
          <pre class="programlisting">
/**
 * Example for use of I18n gt() functions (client side)
 */
class ClientMyPlugin extends ClientPlugin
                     implements GuiProvider, ServerCaller {

    // ...
    
    public function initializeResult($myPluginResult) {
        
        // Retrieves message
        $this-&gt;message = $myPluginResult-&gt;message;
    }

    public function renderForm(Smarty $smarty) {
  
        // Translation and display
        $smarty-&gt;assign('message', I18n::gt($this-&gt;message));
    }
}
</pre>
          <pre class="programlisting">/**
 * Example for use of I18n gt() functions (server side)
 */
class ServerMyPlugin extends ClientResponderAdapter {

    // ...

    public function handlePreDrawing($request) {
        
        $myPluginResult = new MyPluginResult();

        // Message must be translated, but not now!
        $myPluginResult&gt;message = I18nNoop::gt('hello, world');
        
        return $myPluginResult;
    }
}
</pre>
          <p> In this example, message sent by server has to be 
      translated. But as translation process is always done on client, we only 
      indicates to the script that there is a text to add to the translation 
      template.</p>
        </div>
        <div class="sect1" lang="en" xml:lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title"><a id="dev.i18n.encoding"></a>4.2. Character Set Encoding</h2>
              </div>
            </div>
          </div>
          <p> As already described in <a href="user.i18n.html#user.i18n.encoding" title="15.2. Character Set Encoding Configuration">Section 15.2, &#8220;Character Set Encoding Configuration&#8221;</a>, 
      character set encoding is done using <code class="classname">Encoder</code> set 
      of classes. It uses functions <code class="function">Encoder::encode()</code> and 
      <code class="function">Encoder::decode()</code>: </p>
          <div class="itemizedlist">
            <ul>
              <li><code class="function">Encoder::encode($text, $context)</code>: converts 
          text from context's character set to CartoWeb's internal character 
          set (UTF-8) </li>
              <li><code class="function">Encoder::decode($text, $context)</code>: converts 
          text from CartoWeb's internal character set (UTF-8) to context's 
          character</li>
            </ul>
          </div>
          <p> Context can be either 'config' or 'output', default is 'output'. 
      Corresponding configuration is set in <code class="filename">server.ini</code> and 
      <code class="filename">client.ini</code> (see <a href="user.i18n.html#user.i18n.encoding" title="15.2. Character Set Encoding Configuration">Section 15.2, &#8220;Character Set Encoding Configuration&#8221;</a>).</p>
          <p>Function <code class="function">Encoder::encode()</code> must be used in the 
      following situation:</p>
          <div class="itemizedlist">
            <ul>
              <li>on client or server when reading a text from a configuration 
          file:<pre class="programlisting">
$encodedText = Encoder::encode($readText, 'config');</pre> </li>
            </ul>
          </div>
          <p>Function <code class="function">Encoder::decode()</code> must be used in the 
      following situations:</p>
          <div class="itemizedlist">
            <ul>
              <li>on client when outputing a text without calling 
          <code class="function">I18n::gt()</code>:<pre class="programlisting">
$textToDisplay = Encoder::decode($encodedText);</pre> </li>
              <li>on client or server when calling an external module, eg. 
          Mapserver for a query:<pre class="programlisting">
$textToUseInMapserver = Encoder::decode($encodedText, 'config');</pre>
        </li>
            </ul>
          </div>
          <p> Note that function <code class="function">I18n::gt()</code> takes an encoded 
      text as argument and already prepares texts for output. It means you 
      don't need to call <code class="function">Encoder::decode()</code> after a call to 
      <code class="function">I18n::gt()</code>.</p>
        </div>
      </div>
      <div id="w3c">
        <a href="http://validator.w3.org/check/referer">
          <img src="image/xhtml.png" width="88" height="31" alt="valid xhtml 1.0" />
        </a>
        <a href="http://jigsaw.w3.org/css-validator/">
          <img src="image/css.png" width="88" height="31" alt="valid css" />
        </a>
      </div>
    </div>
  </body>
</html>
